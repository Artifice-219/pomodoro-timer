<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="timer-page.css">
  </head>
  <body>
    <h1>Main Timer Page</h1>
    <!-- first time using dialog tag -->
    <dialog open class="dialog">
        <span class="close">&times;</span>
        <label id="task-label" for="timer-task">Task :</label>
        <input type="text" name="timer-task" id="timer-task" />
        <br />
<!-- 
        <label id="timer-amount-labe" for="timer-amount">Focus Time</label>
        <p>20 mins</p> -->

      <!-- <select name="timer-amount" id="timer-amount">
        <option value="20">20 Minutes</option>
        <option value="40">40 Minutes</option>
        <option value="60">1 Hour</option>
      </select>
      <br>

      <label for="timer-break">Timer break</label>
      <select name="timer-break" id="timer-break">
        <option value="5">5 Minutes</option>
        <option value="10">10 Minutes</option>
        <option value="15">15 Minutes</option>
      </select>

      <button id="start-btn">Start Timer</button>
      <button class="back">Go back</button> -->
    </dialog>

   

    <!-- the UI for the timer hidden by default until toggled by some event -->
    <div class="background">
        <div class="timer">
            <h2>Pomodoro Timer</h2>
            <div class="task"></div>
            <div class="focus-time"></div>
            <div class="break-time"></div>

            <div class="clock-face">
              <div class="min">00</div>
              <div class="separator">:</div>
              <div class="sec">00</div>
              <svg class="progress-ring" width="100" height="100">
                <circle class="progress-ring__circle" stroke="blue" stroke-width="4" fill="transparent" r="48" cx="50" cy="50"/>
              </svg>
            </div>
        </div>
    </div>

    <!-- closes the dialog -->
    <script>
      // target the 'X'
      let close = document.querySelector(".close");
      // target the dialog
      let dialog = document.querySelector(".dialog");

      close.addEventListener("click", () => {
        // closes the dialog
        dialog.close();
      });
    </script>

    <!-- for the start button -->
    <script>
      // when the start button is clicked first  check if the timer if the timer-task and the timer-amount have some
      // value on it
      let start_btn = document.querySelector('#start-btn');
      let task_div = document.querySelector('.task');
      let focus_time_div = document.querySelector('.focus-time');
      let  break_time_div = document.querySelector('.break-time');

      let timer_amount = document.querySelector('#timer-amount');
      let break_time = document.querySelector('#timer-break');

      // gets the select value from the select element 
      let focus_time = timer_amount.options[timer_amount.selectedIndex].value;
      let break_time_value = break_time.options[break_time.selectedIndex].value;
      
      start_btn.addEventListener('click', function(){

        let timer_task = document.querySelector("#timer-task");
    
      if(timer_task.value === '' || timer_amount.value === ''){
        alert('Please fill in the task and the amount of time you want to set the timer for');
      }else{
        // reveal the background div whihc holds the timer
        document.querySelector('.background').style.display = 'block';
        // display the timer task to the UI
        task_div.innerHTML = `Task: ${timer_task.value}`;
        focus_time_div.innerHTML = `Time ${focus_time};`;
        break_time_div.innerHTML = `Break ${break_time_value};`;
        
      }
      })
    </script>

    <!-- for the timer's slider -->
     <script>
      // Function to initialize the circular slider
function initializeProgressRing() {
  const circle = document.querySelector('.progress-ring__circle');
  const radius = circle.r.baseVal.value;
  const circumference = radius * 2 * Math.PI;

  circle.style.strokeDasharray = `${circumference} ${circumference}`;
  circle.style.strokeDashoffset = circumference;

  function setProgress(percent) {
    const offset = circumference - (percent / 100) * circumference;
    circle.style.strokeDashoffset = offset;
  }

  // Example usage with a countdown timer
  const totalSeconds = 60; // Change this to the desired timer duration in seconds
  let remainingSeconds = totalSeconds;

  const interval = setInterval(() => {
    if (remainingSeconds <= 0) {
      clearInterval(interval);
      return;
    }

    remainingSeconds--;
    const percent = (remainingSeconds / totalSeconds) * 100;
    setProgress(percent);

    const minutes = Math.floor(remainingSeconds / 60);
    const seconds = remainingSeconds % 60;
    document.querySelector('.min').textContent = String(minutes).padStart(2, '0');
    document.querySelector('.sec').textContent = String(seconds).padStart(2, '0');
  }, 1000);
}

// Initialize the progress ring when the page loads
document.addEventListener('DOMContentLoaded', initializeProgressRing);

     </script>

     <!--  for the go back button -->
       <script>
        let back_btn = document.querySelector('.back');

        back_btn.addEventListener('click',() => {
          window.location.href = 'index.html';
        })
       </script>
  </body>
</html>
